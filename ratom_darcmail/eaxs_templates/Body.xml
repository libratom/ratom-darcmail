
<!--# 
TODO:
    * Make sure you use skipnull and cdata wherever needed.
    * Check all elements against schema for what elements are repeatable and make sure you are
    supporting that.
#-->

            <!--# Get content type. If there is no Content-Type, this falls back to 
            message.get_default_type() aka "text/plain" as required by EAXS. #-->
            <ContentType>{{ message.get_content_type() }}</ContentType>
            
            <Charset>{{ message.get_content_charset(failobj="us-ascii") }}</Charset>

            <!--# TODO: check RFC-4021 for the source of this. It's optional BTW.
            FYI: TOMES DarcMail equates this to Content-Description. #-->
            <ContentName>{{ message.get_params(header="content-description") | skipnull | cdata }}</ContentName>
            
            <!--# TODO: check RFC-4021 for the souce of this. It's optional BTW. #-->
            <ContentTypeComments></ContentTypeComments>
            
            <!--# TODO: document this. #-->
            {% set message_params = DarcMailObject.eaxs_helpers.parse_params(message.get_params()) %}
            {% if message_params|length != 0 %}
            <ContentTypeParam>
            {% for name, value in message_params %}
                <Name>{{ name }}</Name>
                <Value>{{ value }}</Value>
            {% endfor %}
            </ContentTypeParam>
            {% endif %}

            <TransferEncoding>{{ message.get("content-transfer-encoding") | skipnull }}</TransferEncoding>
            
            <!--# TODO: check RFC-4021 for the souce of this. It's optional BTW. #-->
            <TransferEncodingComments></TransferEncodingComments>

            <ContentId>{{ message.get("content-id") | skipnull | cdata }}</ContentId>
  
            <!--# TODO: check RFC-4021 for the souce of this. It's optional BTW. #-->
            <ContentIdComments></ContentIdComments>

            <!--# TODO: still check RFC-4021 for the souce of this; because it's not clear what this
            element is about. It's optional BTW. #-->
            <Description>{{ message.get("content-description") | skipnull | cdata }}</Description>
            
            <!--# TODO: check RFC-4021 for the souce of this. It's optional BTW. #-->
            <DescriptionComments></DescriptionComments>

            <Disposition>{{message.get_content_disposition() | skipnull }}</Disposition>
            <DispositionFileName>{{message.get_filename() | skipnull }}</DispositionFileName>

            <!--# TODO: check RFC-4021 for the souce of this. It's optional BTW. #-->
            <DispositionComments></DispositionComments>

            {% set disposition_params = DarcMailObject.eaxs_helpers.parse_params(
              message.get_params(header="content-disposition"),
              ["filename"])
            %}
            {% if disposition_params|length != 0 %}
            <DispositionParams>
            {% for name, value in disposition_params %}
                <Name>{{ name }}</Name>
                <Value>{{ value }}</Value>
            {% endfor %}
            </DispositionParams>
            {% endif %}

          <!--#
            <element name="OtherMimeHeader" type="xm:header-type" minOccurs="0" maxOccurs="unbounded"/>
            <!-- Skip. This is completely unclear.
            Not currently implemented either.
            -->
            <choice minOccurs="0" maxOccurs="1">
              <element name="BodyContent" type="xm:int-body-content-type">
                <annotation>
                        <documentation>This is textual or binary data that is stored in-line in this XML document that makes up the body of this entity. Along with the character set and transfer encoding used.</documentation>
                </annotation>
              </element>
              <element name="ExtBodyContent" type="xm:ext-body-content-type">
                <annotation>
                        <documentation>This is a pointer to a file that contains the text or binary data that makes up the body of this entity. Along with the character set and transfer encoding used.</documentation>
                </annotation>
              </element>
              <element name="ChildMessage" type="xm:child-message-type"/>
              <!-- This doesn't appear to be implemented at all in current DarcMail.
              It's not clear from EAXS XSD what this is even supposed to mean.
              -->
            </choice>
            <element name="PhantomBody" type="string" minOccurs="0">
              <annotation>
                <documentation>Used for Content-Type message/external-body. US-ASCII character set is assumed.</documentation>
              </annotation>
            </element>
            <!-- Not currently implemented.
            Skip ???
            This is unclear.
            -->
    </sequence>
  </complexType>
  #-->